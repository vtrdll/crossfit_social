{% extends "base.html" %}
{% load static %}
{% block title %}FEED{% endblock %}

{% block content %}
<div class="container py-4">

    <!-- STORIES -->
    <div class="mb-4">
      <div class="d-flex overflow-auto" style="gap: 1rem;">
        {% for story in stories %}
          <div class="text-center">
            <div class="rounded-circle border border-3 border-primary"
                 style="width:70px; height:70px; overflow:hidden; cursor:pointer;"
                 data-bs-toggle="modal"
                 data-bs-target="#storyModal{{ story.id }}">
              {% if story.user.profile.photo %}
                <img src="{{ story.user.profile.photo.url }}"
                     alt="Story de {{ story.user.username }}"
                     class="w-100 h-100" style="object-fit:cover;">
              {% else %}
                <div class="bg-secondary w-100 h-100"></div>
              {% endif %}
            </div>
            <small>{{ story.user.username }}</small>
          </div>

          <!-- üîπ Modal para abrir cada story -->
          <div class="modal fade" id="storyModal{{ story.id }}" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content bg-dark text-white">
                <div class="modal-header border-0">
                  <h6 class="modal-title">{{ story.user.username }}</h6>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body text-center">

                    {% for media in story.media.all %}
                        {% if media.photo %}
                            <img src="{{ media.photo.url }}" class="img-fluid rounded"  alt="Story">
                            {% elif media.video %}
                                <video controls autoplay style="max-width:100%; border-radius:10px;">
                                    <source source src="{{ media.video.url }}" type="video/mp4">
                                    Seu navegador n√£o suporta v√≠deo.
                                </video>
                            {% endif %}
                        {% empty %}
                            <p class="text-muted">Nenhuma m√≠dia dispon√≠vel para este story.</p>
                    {% endfor %}

                </div>
              </div>
            </div>
          </div>
          <!-- üîπ Fim do modal -->

        {% empty %}
          <p class="text-muted">Nenhum story dispon√≠vel.</p>
        {% endfor %}
      </div>
    </div>

    <h1 class="mb-4 text-center">üèãÔ∏è CROSS</h1>

    {# ... resto do SEU feed igual est√°, posts, coment√°rios etc ... #}

</div>
{% endblock %}
